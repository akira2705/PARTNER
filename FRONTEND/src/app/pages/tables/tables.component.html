<div class="tables-page">

  <section class="page-header">
    <div class="header-content">
      <h1>Restaurant Floor Plan</h1>
      <p>Visual layout of table arrangement and availability</p>
    </div>
  </section>

  <div *ngIf="loading" class="loading-state">
    <div class="spinner"></div>
    <p>Loading floor plan</p>
  </div>

  <div *ngIf="!loading && tables.length > 0" class="layout-container">
    <div class="legend">
      <div class="legend-item">
        <div class="legend-indicator available"></div>
        <span>Available</span>
      </div>
      <div class="legend-item">
        <div class="legend-indicator reserved"></div>
        <span>Reserved</span>
      </div>
      <div class="legend-item">
        <div class="legend-indicator occupied"></div>
        <span>Occupied</span>
      </div>
    </div>

    <div class="room-layout">
      <div class="room-background">
        <div class="room-label">Main Dining Area</div>
      </div>
      
      <div 
        *ngFor="let table of getTabulatedTables()"
        class="table-position"
        [style.left.%]="table.position.x"
        [style.top.%]="table.position.y"
      >
        <div 
          class="table-item"
          [ngClass]="'status-' + table.status.toLowerCase()"
          (click)="selectTable(table)"
        >
          <!-- Seats positioned around the table -->
          <div 
            *ngFor="let seat of getSeatsArray(table.capacity); let i = index"
            class="seat"
            [style.--seat-index]="i"
            [attr.data-seat]="i + 1"
          ></div>
          
          <!-- Table center -->
          <div class="table-center">
            <div class="table-id">T{{ table.table_number }}</div>
            <div class="table-capacity-label">{{ table.capacity }} seats</div>
          </div>
        </div>
      </div>
    </div>

    <div *ngIf="selectedTable" class="table-detail-panel">
      <div class="detail-header">
        <h3>Table {{ selectedTable.table_number }}</h3>
        <button class="close-btn" (click)="selectedTable = null">Ã—</button>
      </div>
      <div class="detail-content">
        <div class="detail-row">
          <span class="label">Capacity:</span>
          <span class="value">{{ selectedTable.capacity }} seats</span>
        </div>
        <div class="detail-row">
          <span class="label">Type:</span>
          <span class="value">{{ selectedTable.type }}</span>
        </div>
        <div class="detail-row">
          <span class="label">Status:</span>
          <span class="value status-badge" [ngClass]="'badge-' + selectedTable.status.toLowerCase()">
            {{ selectedTable.status }}
          </span>
        </div>
        <div *ngIf="selectedTable.current_customer_id" class="detail-row">
          <span class="label">Guest ID:</span>
          <span class="value">{{ selectedTable.current_customer_id }}</span>
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="!loading && tables.length === 0" class="empty-state-message">
    <p>No tables found</p>
  </div>

</div>
